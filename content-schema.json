{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/LegendaryMediaTV/EGP-Graphai/content-schema.json",
  "title": "EGP Graphai â€¢ Content Schema",
  "description": "Flexible schema for multilingual or structured text content, supporting simple strings, structured objects, and arrays for multiple content entries.",
  "$defs": {
    "marks": {
      "type": "array",
      "items": { "type": "string", "enum": ["i", "b", "woc", "sc"] },
      "uniqueItems": true,
      "description": "Formatting marks: i = italic, b = bold, woc = words of Christ (red lettering), sc = small caps"
    },
    "footnote": {
      "type": "object",
      "description": "Footnote attached to the end of the content.",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["stu", "trn", "var", "map", "xrf"],
          "default": "stu",
          "description": "Kind of footnote: stu (study, default), trn (translation), var (textual criticism variant), map (map), xrf (cross-reference)."
        },
        "content": {
          "$ref": "#",
          "description": "Any valid content type (i.e., string, object, or array)."
        }
      },
      "required": ["content"],
      "additionalProperties": false
    },
    "strongsNumber": {
      "type": "string",
      "pattern": "^[GH][0-9]{1,4}$",
      "description": "Strong's number."
    },
    "lemma": {
      "type": "string",
      "description": "Lexical lemma in original script."
    },
    "morphology": {
      "type": "string",
      "description": "Morphological code (i.e., Robinson or Packard format)."
    },
    "paragraphFlag": {
      "type": "boolean",
      "default": false,
      "description": "Indicates this is the start of a new paragraph."
    },
    "lineBreak": {
      "type": "boolean",
      "default": false,
      "description": "Indicates this ends with a line break."
    }
  },
  "oneOf": [
    {
      "type": "string",
      "minLength": 1,
      "description": "Plain text."
    },
    {
      "type": "object",
      "description": "Structured content object for plain text.",
      "properties": {
        "text": {
          "type": "string",
          "description": "Plain text."
        },
        "script": {
          "type": "string",
          "enum": ["G", "H"],
          "description": "Specifies the script of the text. If not specified, Latin script is assumed."
        },
        "marks": { "$ref": "#/$defs/marks" },
        "foot": { "$ref": "#/$defs/footnote" },
        "strong": { "$ref": "#/$defs/strongsNumber" },
        "lemma": { "$ref": "#/$defs/lemma" },
        "morph": { "$ref": "#/$defs/morphology" },
        "paragraph": { "$ref": "#/$defs/paragraphFlag" },
        "break": { "$ref": "#/$defs/lineBreak" }
      },
      "minProperties": 1,
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Structured content object for nested content with shared properties (e.g., Strong's number applying to multiple text elements).",
      "properties": {
        "content": {
          "$ref": "#",
          "description": "Nested content array or element."
        },
        "marks": { "$ref": "#/$defs/marks" },
        "foot": { "$ref": "#/$defs/footnote" },
        "strong": { "$ref": "#/$defs/strongsNumber" },
        "lemma": { "$ref": "#/$defs/lemma" },
        "morph": { "$ref": "#/$defs/morphology" },
        "paragraph": { "$ref": "#/$defs/paragraphFlag" },
        "break": { "$ref": "#/$defs/lineBreak" }
      },
      "required": ["content"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Structured content object for headings.",
      "properties": {
        "heading": {
          "$ref": "#",
          "description": "Any valid content type (i.e., string, object, or array)."
        }
      },
      "required": ["heading"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Structured content object for paragraphs.",
      "properties": {
        "paragraph": {
          "$ref": "#",
          "description": "Any valid content type (i.e., string, object, or array)."
        }
      },
      "required": ["paragraph"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Structured content object for subtitles.",
      "properties": {
        "subtitle": {
          "$ref": "#",
          "description": "Any valid content type (i.e., string, object, or array)."
        }
      },
      "required": ["subtitle"],
      "additionalProperties": false
    },
    {
      "type": "array",
      "description": "Array of content entries, allowing for multiple text elements or nested structures.",
      "items": { "$ref": "#" },
      "minItems": 1
    }
  ]
}
